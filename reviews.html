<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SoulNode - Reviews</title>
    <link rel="stylesheet" href="css/page-css/reviews.css">
</head>
<body>
    <div class="container">
        <h1>Reviews White Discord</h1>
        <form id="discordForm">

            <label for="rating">Rating:</label>
            <div class="star-rating" id="starRating">
                <span class="star" data-value="1">&#9733;</span>
                <span class="star" data-value="2">&#9733;</span>
                <span class="star" data-value="3">&#9733;</span>
                <span class="star" data-value="4">&#9733;</span>
                <span class="star" data-value="5">&#9733;</span>
            </div>
            <label for="discordUsername">Discord Username:</label>
            <input type="text" id="discordUsername" name="discordUsername" placeholder="Your Discord Username">
            <label for="message">Message:</label>
            <textarea id="message" name="message" rows="4" placeholder="Your message"></textarea>
            <input type="submit" value="Envoyer">
        </form>
    </div>

    <script>
        const stars = document.querySelectorAll('.star');
        let selectedRating = 0;

        stars.forEach(star => {
            star.addEventListener('click', () => {
                selectedRating = star.getAttribute('data-value');
                stars.forEach(s => s.classList.remove('selected'));
                star.classList.add('selected');
                let previousSibling = star.previousElementSibling;
                while (previousSibling) {
                    previousSibling.classList.add('selected');
                    previousSibling = previousSibling.previousElementSibling;
                }
            });
        });

        document.getElementById("discordForm").addEventListener("submit", function(event) {
    event.preventDefault();
    const discordUsername = document.getElementById("discordUsername").value.trim();
    const message = document.getElementById("message").value.trim();

    if (discordUsername === "") {
        alert("Veuillez entrer votre pseudo Discord.");
        return;
    }

    if (message === "") {
        alert("Veuillez entrer un message.");
        return;
    }

    if (selectedRating === 0) {
        alert("Veuillez sélectionner une note.");
        return;
    }

    const webhookUrl = "https://discord.com/api/webhooks/1232756330322858048/kV8Ca3orvc0lCB9zZDCpZUWIvjW5e6M7JcfoHwFnje9AUd2d8HVqadACTRmlyj5SLw-5";

    const payload = {
        embeds: [{
            title: "New Review",
            description: message,
            color: 0x18184e,
            fields: [
                {
                    name: "Username",
                    value: discordUsername,
                    inline: true
                },
                {
                    name: "Rating",
                    value: `${selectedRating} stars`,
                    inline: true
                }
            ]
        }]
    };

    fetch(webhookUrl, {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify(payload)
    })
    .then(response => {
        if (!response.ok) {
            throw new Error("Erreur lors de l'envoi du message.");
        }
        alert("Message envoyé avec succès!");
        document.getElementById("discordUsername").value = "";
        document.getElementById("message").value = "";
        selectedRating = 0;
        stars.forEach(s => s.classList.remove('selected'));
    })
    .catch(error => {
        console.error("Erreur:", error);
        alert("Une erreur s'est produite. Veuillez réessayer.");
    });
});

    </script>
</body>
</html>
